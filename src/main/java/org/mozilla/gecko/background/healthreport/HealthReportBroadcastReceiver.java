/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

package org.mozilla.gecko.background.healthreport;

import java.io.File;

import org.json.simple.JSONObject;
import org.mozilla.gecko.AppConstants;
import org.mozilla.gecko.background.common.log.Logger;
import org.mozilla.gecko.background.healthreport.HealthReportDatabaseStorage.DatabaseEnvironment;
import org.mozilla.gecko.sync.ExtendedJSONObject;

import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class HealthReportBroadcastReceiver extends BroadcastReceiver {
  public static final String LOG_TAG = HealthReportBroadcastReceiver.class.getSimpleName();

  // public static final String DUMMY_PAYLOAD = "{\"lastPingDate\": \"2013-05-08\", \"data\": {\"last\": {\"org.mozilla.appSessions.current\": {\"totalTime\": 587666, \"activeTicks\": 7919, \"_v\": 3, \"startDay\": 15827, \"firstPaint\": 2293, \"main\": 32, \"sessionRestored\": 2337}, \"org.mozilla.sysinfo.sysinfo\": {\"version\": \"11.4.2\", \"_v\": 1, \"memoryMB\": 8192, \"cpuCount\": 8, \"architecture\": \"x86-64\", \"name\": \"Darwin\"}, \"org.mozilla.addons.active\": {\"verticaltabs@philikon.de\": {\"foreignInstall\": false, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"0.9.4\", \"hasBinaryComponents\": false, \"scope\": 1, \"updateDay\": 15813, \"type\": \"extension\", \"installDay\": 15761}, \"{f67054b9-d9c3-5cfe-6e84-4f9878f0022c}\": {\"foreignInstall\": true, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"0.1.44.28\", \"scope\": 8, \"updateDay\": 15818, \"type\": \"plugin\", \"installDay\": 15818}, \"_v\": 1, \"{07b90314-1e79-c84a-4b47-fb7e1853be39}\": {\"foreignInstall\": true, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"14.6.1\", \"scope\": 8, \"updateDay\": 15139, \"type\": \"plugin\", \"installDay\": 15139}, \"web2pdfextension@web2pdf.adobedotcom\": {\"foreignInstall\": true, \"userDisabled\": true, \"appDisabled\": true, \"version\": \"1.1\", \"hasBinaryComponents\": true, \"scope\": 8, \"updateDay\": 15782, \"type\": \"extension\", \"installDay\": 15782}, \"{d95f2237-07c7-b389-7956-65e6f1ce8e0a}\": {\"foreignInstall\": true, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"7.7.1\", \"scope\": 8, \"updateDay\": 15233, \"type\": \"plugin\", \"installDay\": 15233}, \"jid0-NgMDcEu2B88AbzZ6ulHodW9sJzA@jetpack\": {\"foreignInstall\": false, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"3.1.0\", \"hasBinaryComponents\": false, \"scope\": 1, \"updateDay\": 15761, \"type\": \"extension\", \"installDay\": 15761}, \"onepassword@agilebits.com\": {\"foreignInstall\": false, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"3.9.14\", \"hasBinaryComponents\": false, \"scope\": 1, \"updateDay\": 15821, \"type\": \"extension\", \"installDay\": 15821}, \"{f7bc8076-12cd-09c3-7f36-94287a9880f9}\": {\"foreignInstall\": true, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"11.7.700.169\", \"scope\": 8, \"updateDay\": 15827, \"type\": \"plugin\", \"installDay\": 15827}, \"support@lastpass.com\": {\"foreignInstall\": false, \"userDisabled\": true, \"appDisabled\": false, \"version\": \"2.0.20\", \"hasBinaryComponents\": true, \"scope\": 1, \"updateDay\": 15821, \"type\": \"extension\", \"installDay\": 15821}, \"{d10d0bf8-f5b5-c8b4-a8b2-2b9879e08c5d}\": {\"foreignInstall\": false, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"2.2.4\", \"hasBinaryComponents\": false, \"scope\": 1, \"updateDay\": 15833, \"type\": \"extension\", \"installDay\": 15761}, \"{7fdef2b7-bec6-2731-0f56-f7a57df45a36}\": {\"foreignInstall\": true, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"3.18.3.12840\", \"scope\": 8, \"updateDay\": 15818, \"type\": \"plugin\", \"installDay\": 15818}, \"masspasswordreset@johnathan.nightingale\": {\"foreignInstall\": false, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"1.05\", \"hasBinaryComponents\": false, \"scope\": 1, \"updateDay\": 15761, \"type\": \"extension\", \"installDay\": 15761}, \"{7efdde5b-34a0-64cd-10a0-0969122fd98b}\": {\"foreignInstall\": true, \"userDisabled\": false, \"appDisabled\": false, \"version\": \"3.18.3.12840\", \"scope\": 8, \"updateDay\": 15750, \"type\": \"plugin\", \"installDay\": 15750}}, \"org.mozilla.profile.age\": {\"_v\": 1, \"profileCreation\": 15761}, \"org.mozilla.appInfo.appinfo\": {\"xpcomabi\": \"x86_64-gcc3\", \"vendor\": \"Mozilla\", \"name\": \"Firefox\", \"appBuildID\": \"20130427004014\", \"locale\": \"en-US\", \"_v\": 2, \"distributionID\": \"\", \"platformBuildID\": \"20130427004014\", \"version\": \"22.0a2\", \"platformVersion\": \"22.0a2\", \"distributionVersion\": \"\", \"hotfixVersion\": \"\", \"os\": \"Darwin\", \"id\": \"{ec8030f7-c20a-464f-9b0e-13a3a9e97384}\", \"updateChannel\": \"aurora\"}}, \"days\": {\"2013-03-08\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 118032}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 4, \"google.urlbar\": 1}}, \"2013-04-19\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 201, \"pages\": 120606}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 11, \"google.urlbar\": 7}}, \"2013-04-18\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [5388], \"_v\": 3, \"firstPaint\": [11678, 1967], \"abortedActiveTicks\": [54], \"cleanTotalTime\": [365030], \"abortedTotalTime\": [39715], \"main\": [7874, 35], \"sessionRestored\": [11738, 2032]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 200, \"pages\": 121218}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130417004018\"], \"appBuildID\": [\"20130417004018\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 21, \"google.urlbar\": 4}}, \"2013-04-30\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 211, \"pages\": 124616}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 25, \"google.urlbar\": 3}}, \"2013-03-09\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 118379}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 1, \"google.urlbar\": 1}}, \"2013-04-03\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 185, \"pages\": 120108}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130401042013\"], \"appBuildID\": [\"20130401042013\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 24, \"google.urlbar\": 3}}, \"2013-04-11\": {\"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 194, \"pages\": 121898}, \"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 1}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130410004014\"], \"appBuildID\": [\"20130410004014\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 21, \"google.urlbar\": 4}}, \"2013-04-10\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 194, \"pages\": 121693}, \"org.mozilla.appSessions.previous\": {\"_v\": 3, \"firstPaint\": [1467], \"abortedActiveTicks\": [3522], \"abortedTotalTime\": [164674], \"main\": [47], \"sessionRestored\": [1492]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 21, \"google.urlbar\": 7}}, \"2013-04-13\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 195, \"pages\": 122455}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130411004016\"], \"appBuildID\": [\"20130411004016\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 10}}, \"2013-04-12\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 194, \"pages\": 122314}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [5788], \"_v\": 3, \"firstPaint\": [1347], \"cleanTotalTime\": [348286], \"main\": [34], \"sessionRestored\": [1382]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 19, \"google.urlbar\": 3}}, \"2013-04-15\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 199, \"pages\": 123594}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 26, \"google.urlbar\": 5}}, \"2013-04-14\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 196, \"pages\": 123049}, \"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 1}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 14, \"google.urlbar\": 4}}, \"2013-04-17\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [1485], \"_v\": 3, \"firstPaint\": [4460], \"cleanTotalTime\": [43991], \"main\": [242], \"sessionRestored\": [4583]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 200, \"pages\": 122737}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130416004017\"], \"appBuildID\": [\"20130416004017\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 22, \"google.urlbar\": 2}}, \"2013-04-16\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 199, \"pages\": 124062}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [864], \"_v\": 3, \"firstPaint\": [3323], \"cleanTotalTime\": [20812], \"main\": [32], \"sessionRestored\": [3395]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 34, \"google.urlbar\": 1}}, \"2013-03-10\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 118600}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 2}}, \"2013-03-11\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 118694}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 14}}, \"2013-03-12\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 118883}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 18, \"google.urlbar\": 4}}, \"2013-04-01\": {\"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 11}}, \"2013-03-14\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119754}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 32, \"google.urlbar\": 2}}, \"2013-03-15\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 120139}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [398, 788], \"_v\": 3, \"firstPaint\": [3112, 3811], \"cleanTotalTime\": [12557, 108481], \"main\": [31, 1899], \"sessionRestored\": [3166, 3950]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 8, \"google.urlbar\": 4}}, \"2013-03-16\": {\"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 2}}, \"2013-03-17\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119525}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [851], \"_v\": 3, \"firstPaint\": [16156], \"cleanTotalTime\": [94125], \"main\": [9690], \"sessionRestored\": [16431]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 3}}, \"2013-03-18\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119588}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [252, 3960], \"_v\": 3, \"firstPaint\": [2405, 3328], \"cleanTotalTime\": [40768, 263032], \"main\": [32, 942], \"sessionRestored\": [2451, 3396]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 30, \"google.urlbar\": 3}}, \"2013-04-06\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [4009], \"_v\": 3, \"firstPaint\": [1573, 3310], \"abortedActiveTicks\": [6], \"cleanTotalTime\": [254148], \"abortedTotalTime\": [40], \"main\": [36, 60], \"sessionRestored\": [2257, 3395]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 189, \"pages\": 121111}, \"org.mozilla.appInfo.versions\": {\"platformVersion\": [\"22.0a2\"], \"_v\": 2, \"platformBuildID\": [\"20130405004016\"], \"appVersion\": [\"22.0a2\"], \"appBuildID\": [\"20130405004016\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.urlbar\": 1}}, \"2013-02-28\": {\"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 1}}, \"2013-03-30\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119109}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 1}}, \"2013-04-07\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 189, \"pages\": 121336}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 42, \"google.urlbar\": 1}}, \"2013-04-04\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 187, \"pages\": 120574}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [2478], \"_v\": 3, \"firstPaint\": [1847], \"cleanTotalTime\": [105549], \"main\": [32], \"sessionRestored\": [1875]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 37}}, \"2013-02-14\": {\"org.mozilla.crashes.crashes\": {\"_v\": 1, \"submitted\": 1}}, \"2013-04-05\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 189, \"pages\": 120749}, \"org.mozilla.appSessions.previous\": {\"_v\": 3, \"firstPaint\": [11325], \"abortedActiveTicks\": [93], \"abortedTotalTime\": [2670], \"main\": [8619], \"sessionRestored\": [21101]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 32, \"google.urlbar\": 3}}, \"2013-05-05\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 215, \"pages\": 125857}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 2, \"google.urlbar\": 1}}, \"2013-05-04\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 214, \"pages\": 125642}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 11, \"google.urlbar\": 4}}, \"2013-05-07\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 217, \"pages\": 126843}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 25, \"google.urlbar\": 4}}, \"2013-05-06\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 216, \"pages\": 126413}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 16}}, \"2013-05-01\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 213, \"pages\": 125260}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 24, \"google.urlbar\": 1}}, \"2013-05-03\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 214, \"pages\": 125066}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130427004014\"], \"appBuildID\": [\"20130427004014\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 12}}, \"2013-05-02\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 214, \"pages\": 125667}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 18}}, \"2013-05-09\": {\"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 5}}, \"2013-05-08\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 217, \"pages\": 127094}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 35, \"google.urlbar\": 1}}, \"2013-03-13\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 119213}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [13, 3639], \"_v\": 3, \"firstPaint\": [3690, 1233], \"cleanTotalTime\": [68, 166053], \"main\": [31, 37], \"sessionRestored\": [3760, 1257]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 9, \"google.urlbar\": 1}}, \"2013-04-08\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 193, \"pages\": 122105}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 67, \"google.urlbar\": 2}}, \"2013-04-09\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [43, 2032], \"_v\": 3, \"firstPaint\": [22106, 1865], \"cleanTotalTime\": [2155, 136648], \"main\": [16917, 518], \"sessionRestored\": [22935, 1900]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 194, \"pages\": 121942}, \"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 1}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130408004015\"], \"appBuildID\": [\"20130408004015\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 7, \"google.urlbar\": 6}}, \"2013-04-28\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 208, \"pages\": 123381}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 5, \"google.urlbar\": 1}}, \"2013-04-29\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 209, \"pages\": 124035}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 29, \"google.urlbar\": 3}}, \"2013-04-24\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 204, \"pages\": 121887}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 28, \"google.urlbar\": 6}}, \"2013-04-25\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 206, \"pages\": 122451}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 29}}, \"2013-04-26\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [250, 15, 9985], \"_v\": 3, \"firstPaint\": [11908, 2777, 1288], \"cleanTotalTime\": [1741, 78, 580796], \"main\": [7531, 1253, 39], \"sessionRestored\": [12458, 3201, 1313]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 207, \"pages\": 122788}, \"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 3}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130422004013\"], \"appBuildID\": [\"20130422004013\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 20, \"google.urlbar\": 2}}, \"2013-04-27\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 208, \"pages\": 123024}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 7, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 1, \"google.urlbar\": 1}}, \"2013-04-20\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 202, \"pages\": 120820}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 2, \"google.urlbar\": 1}}, \"2013-04-21\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 202, \"pages\": 121136}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 1}}, \"2013-04-22\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 202, \"pages\": 121424}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [5668], \"_v\": 3, \"firstPaint\": [7077], \"cleanTotalTime\": [282670], \"main\": [45], \"sessionRestored\": [7110]}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 22, \"google.urlbar\": 5}}, \"2013-04-23\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 202, \"pages\": 121451}, \"org.mozilla.appInfo.appinfo\": {\"isBlocklistEnabled\": 1, \"_v\": 2, \"isDefaultBrowser\": 1, \"isTelemetryEnabled\": 1}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130418004017\"], \"appBuildID\": [\"20130418004017\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 16, \"google.urlbar\": 5}}, \"2013-03-07\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 117790}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 9, \"google.urlbar\": 2}}, \"2013-03-06\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 117484}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 7}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 7, \"google.urlbar\": 2}}, \"2013-03-05\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [8, 1489, 3], \"_v\": 3, \"firstPaint\": [2411, 2202, 8820], \"cleanTotalTime\": [38, 70637, 311], \"main\": [45, 423, 4837], \"sessionRestored\": [2467, 2238, 9036]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 183, \"pages\": 117061}, \"org.mozilla.appInfo.versions\": {\"_v\": 1, \"version\": [\"21.0a2\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 4, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 11}}, \"2013-03-29\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 118993}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130327042013\"], \"appBuildID\": [\"20130327042013\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 2}}, \"2013-03-28\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [2493], \"_v\": 3, \"firstPaint\": [3004], \"cleanTotalTime\": [402919], \"main\": [33], \"sessionRestored\": [3082]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 118575}, \"org.mozilla.appInfo.versions\": {\"_v\": 2, \"platformBuildID\": [\"20130323042013\"], \"appBuildID\": [\"20130323042013\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 21, \"google.urlbar\": 2}}, \"2013-03-01\": {\"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [5344], \"_v\": 3, \"firstPaint\": [629], \"cleanTotalTime\": [287696], \"main\": [32], \"sessionRestored\": [6450]}}, \"2013-03-25\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 118175}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 15, \"google.urlbar\": 5}}, \"2013-03-31\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119284}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 1}}, \"2013-03-27\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119031}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [2180], \"_v\": 3, \"firstPaint\": [2463], \"cleanTotalTime\": [114498], \"main\": [33], \"sessionRestored\": [2511]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 12, \"google.urlbar\": 3}}, \"2013-03-26\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 118654}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 7, \"google.urlbar\": 1}}, \"2013-03-21\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 120185}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [580], \"_v\": 3, \"firstPaint\": [2578], \"cleanTotalTime\": [38559], \"main\": [30], \"sessionRestored\": [2655]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 10, \"google.urlbar\": 1}}, \"2013-03-20\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119802}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 26, \"google.urlbar\": 2}}, \"2013-03-23\": {\"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 117924}, \"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 1}, \"org.mozilla.appInfo.versions\": {\"platformVersion\": [\"21.0a2\"], \"_v\": 2, \"platformBuildID\": [\"20130322042013\"], \"appBuildID\": [\"20130322042013\"]}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 1, \"google.urlbar\": 1}}, \"2013-03-22\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119189}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [196, 4382], \"_v\": 3, \"firstPaint\": [4270, 6661], \"cleanTotalTime\": [49243, 423648], \"main\": [1522, 3486], \"sessionRestored\": [4445, 6882]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 15, \"google.urlbar\": 2}}, \"2013-01-23\": {\"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 1}}, \"2013-03-19\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119614}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 29}}, \"2013-03-24\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 117976}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 1, \"google.searchbar\": 5, \"google.urlbar\": 1}}, \"2013-04-02\": {\"org.mozilla.places.places\": {\"_v\": 1, \"bookmarks\": 184, \"pages\": 119830}, \"org.mozilla.appSessions.previous\": {\"cleanActiveTicks\": [3397], \"_v\": 3, \"firstPaint\": [3238], \"cleanTotalTime\": [173959], \"main\": [32], \"sessionRestored\": [3292]}, \"org.mozilla.appInfo.appinfo\": {\"_v\": 1, \"isDefaultBrowser\": 1}, \"org.mozilla.addons.counts\": {\"_v\": 1, \"theme\": 1, \"extension\": 5, \"plugin\": 6}, \"org.mozilla.searches.counts\": {\"_v\": 2, \"google.searchbar\": 24, \"google.urlbar\": 3}}, \"2013-02-21\": {\"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 1}}, \"2013-02-27\": {\"org.mozilla.crashes.crashes\": {\"_v\": 1, \"pending\": 3}}}}, \"version\": 2, \"thisPingDate\": \"2013-05-09\", \"geckoAppInfo\": {\"vendor\": \"Mozilla\", \"name\": \"Firefox\", \"appBuildID\": \"20130427004014\", \"_v\": 1, \"version\": \"22.0a2\", \"platformBuildID\": \"20130427004014\", \"platformVersion\": \"22.0a2\", \"xpcomabi\": \"x86_64-gcc3\", \"os\": \"Darwin\", \"id\": \"{ec8030f7-c20a-464f-9b0e-13a3a9e97384}\", \"updateChannel\": \"aurora\"}}";

  @Override
  public void onReceive(Context context, Intent intent) {
    final String action = intent.getAction();
    Logger.warn(LOG_TAG, "Got broadcast with action " + action);

    if (!HealthReportConstants.ACTION_HEALTH_REPORT_REQUEST.equals(action)) {
      return;
    }

    String token = intent.getStringExtra("token");
    Logger.warn(LOG_TAG, "Got broadcast extra token " + token);

    if (token == null) {
      Logger.warn(LOG_TAG, "Got null token");
      setResultCode(Activity.RESULT_CANCELED);
      setResultData(null);
      return;
    }

    String profileDir = null;
    try {
      ExtendedJSONObject o = new ExtendedJSONObject(token);
      profileDir = o.getString("profileDir");
      if (profileDir == null) {
        Logger.warn(LOG_TAG, "Got null profileDir");
        setResultCode(Activity.RESULT_CANCELED);
        setResultData(null);
        return;
      }
    } catch (Exception e) {
      Logger.warn(LOG_TAG, "Got exception parsing token", e);
      setResultCode(Activity.RESULT_CANCELED);
      setResultData(null);
      return;
    }

    HealthReportDatabases databases = new HealthReportDatabases(context);
    HealthReportDatabaseStorage storage = databases.getDatabaseHelperForProfile(new File(profileDir));

    DatabaseEnvironment environment = storage.getEnvironment();
    environment.appName = AppConstants.MOZ_APP_NAME;
    environment.appVersion = AppConstants.MOZ_APP_VERSION;
    environment.appID = AppConstants.MOZ_APP_ID;
    environment.appBuildID = AppConstants.MOZ_APP_BUILDID;

    environment.register();

    HealthReportGenerator generator = new HealthReportGenerator(storage);
    JSONObject report = generator.generateDocument(HealthReportConstants.EARLIEST_LAST_PING,
        HealthReportConstants.EARLIEST_LAST_PING, environment);

    setResultCode(Activity.RESULT_OK);
    setResultData(report.toJSONString());

    abortBroadcast();
  }
}
